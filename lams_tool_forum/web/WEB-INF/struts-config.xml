<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE struts-config PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 1.2//EN" "http://jakarta.apache.org/struts/dtds/struts-config_1_2.dtd">

<struts-config>

  <!-- ========== Data Sources Definitions =================================== -->
  <!--
    Define your Struts data sources in a file called struts-data-sources.xml and place
    it in your merge directory.
  -->

  <!-- ========== Form Bean Definitions =================================== -->
  <form-beans>

    <form-bean
      name="forumForm"
      type="org.lamsfoundation.lams.tool.forum.web.forms.ForumForm"
    />
    <form-bean
      name="messageForm"
      type="org.lamsfoundation.lams.tool.forum.web.forms.MessageForm"
    />

  </form-beans>

  <!-- ========== Global Exceptions Definitions =================================== -->
      <!-- B: global exceptions -->
    <global-exceptions>
	    <exception key="error.operation.failed"
		    type="java.lang.Exception" path="tiles:/error"/>
    </global-exceptions>
    <!-- B: end of global exceptions -->

  <!-- ========== Global Forward Definitions =================================== -->
  	<!-- B: global forwards -->
	<global-forwards>
        <forward   name="forum.error"	path="tiles:/error.jsp"/>
	</global-forwards>
	<!-- E: global forwards -->

  <!-- ========== Action Mapping Definitions =================================== -->
   <action-mappings>

   		<!-- ========== Action Mapping Definitions ============================== -->
		<!-- ========== BEGIN: Authroing Definitions ============================== -->
		<action path="/authoring/init"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			name="forumForm" 
			scope="request" 
			parameter="initPage" 
			validate="false">
			<forward name="success" path="/jsps/authoring/authoring.jsp" />
		</action>

		<action path="/authoring/update"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			name="forumForm" 
			scope="request" 
			parameter="updateContent" 
			validate="false">
			<forward name="success" path="/jsps/authoring/authoring.jsp" />
		</action>

		<action path="/authoring/uploadOnline"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			name="forumForm" 
			scope="request" 
			parameter="uploadOnline" 
			validate="false">
			<forward name="success" path="/jsps/authoring/authoring.jsp" />
		</action>
		<action path="/authoring/uploadOffline"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			name="forumForm" 
			scope="request" 
			parameter="uploadOffline" 
			validate="false">
			<forward name="success" path="/jsps/authoring/authoring.jsp" />
		</action>
		<action path="/authoring/deleteOnline"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			parameter="deleteOnline" >
			<forward name="success" path="/jsps/authoring/authoring.jsp" />
		</action>
		<action path="/authoring/deleteOffline"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			parameter="deleteOffline" >
			<forward name="success" path="/jsps/authoring/authoring.jsp" />
		</action>
		<action path="/authoring/newTopic"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			parameter="newTopic">
			<forward name="success" path="tiles:/authoring/forum/newTopic" />
		</action>
		<action path="/authoring/createTopic"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			name="messageForm" 
			validate="true"
			input="tiles:/authoring/forum/newTopic" 
			parameter="createTopic"
			scope="request">
			<forward name="success" path="tiles:/authoring/forum/newTopic" />
		</action>
		<action path="/authoring/deleteTopic"
			type="org.lamsfoundation.lams.tool.forum.web.actions.AuthoringAction"
			input="tiles:/authoring/forum/create" 
			parameter="deleteTopic"
			scope="request">
		</action>
		<!-- ========== END: Authroing Definitions ============================== -->
		<!-- Message related actions -->
		<action path="/learning/forum/open"
			type="org.lamsfoundation.lams.tool.forum.web.actions.LearningAction"
			parameter="openForum" scope="request">
			<forward name="success" path="tiles:/learning/forum/open" />
		</action>
		<action path="/learning/message/openTopic"
			type="org.lamsfoundation.lams.tool.forum.web.actions.LearningAction"
			parameter="openTopic" scope="request">
			<forward name="success" path="tiles:/learning/message/open" />
		</action>
		<action path="/learning/message/getMessage"
			type="org.lamsfoundation.lams.tool.forum.web.actions.LearningAction"
			parameter="getMessage" scope="request">
			<forward name="success" path="tiles:/learning/message/getMessage" />
		</action>
		<action path="/learning/message/post"
			type="org.lamsfoundation.lams.tool.forum.web.actions.LearningAction"
			parameter="post" scope="request">
			<forward name="success" path="tiles:/learning/message/post" />
		</action>
		<action path="/learning/message/reply"
			type="org.lamsfoundation.lams.tool.forum.web.actions.LearningAction"
			name="messageForm" validate="true" input="tiles:/learning/message/post"
			parameter="reply" scope="request">
			<forward name="success" path="/learning/message/openTopic.do" />
		</action>
		<action path="/learning/message/editMessage"
			type="org.lamsfoundation.lams.tool.forum.web.actions.LearningAction"
			name="messageForm" validate="true"
			input="tiles:/learning/message/getMessage" parameter="editMessage"
			scope="request">
			<forward name="success" path="/learning/message/openTopic.do" />
		</action>
		<action path="/learning/message/delete"
			type="org.lamsfoundation.lams.tool.forum.web.actions.ForumAction"
			parameter="deleteMessage" scope="request">
			<forward name="success" path="/learing/message/open.do" />
		</action>
		<!-- System level actions -->
		<action path="/index" type="org.apache.struts.actions.ForwardAction"
			parameter="tiles:/layout" />
		<action path="/error" type="org.apache.struts.actions.ForwardAction"
			parameter="tiles:/error" />
		<action path="/blank" type="org.apache.struts.actions.ForwardAction"
			parameter="tiles:/blank" />

  </action-mappings>

   <!-- Define your Struts controller in a file called struts-controller.xml and place it in your merge directory. -->

  <message-resources parameter="org.lamsfoundation.lams.tool.forum.web.ApplicationResources" />

  <!-- Put custom struts plugin here -->
<plug-in className="org.apache.struts.validator.ValidatorPlugIn">
	<set-property property="pathnames"
		value="/WEB-INF/struts/validator-rules.xml,/WEB-INF/struts/validation.xml" />
</plug-in>

<plug-in className="org.apache.struts.tiles.TilesPlugin">
	<set-property property="definitions-config" value="/WEB-INF/struts/tiles-defs.xml"/>
</plug-in>
<!--
<plug-in className="net.sf.struts.saif.SAIFPlugin">
	<set-property property="interceptor-config" value="/WEB-INF/interceptor-config.xml" />
</plug-in>
-->

</struts-config>
