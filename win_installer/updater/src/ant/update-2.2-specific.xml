<?xml version="1.0" encoding="UTF-8"?>
<project name="update-2.2-specific" basedir="."> 
    
    <property file="update-2.2-specific.properties" />

    <target name="copy-wrapper.conf" description="Updates wrapper.conf to have the newest configuration">
      
        <copy failonerror="false" file="${INSTDIR}/jboss-4.0.2/conf/wrapper.conf" tofile="${INSTDIR}/jboss-4.0.2/conf/wrapper.conf.bak"/>
        
        <copy overwrite="yes" todir="${INSTDIR}/jboss-4.0.2/conf/">
            <fileset dir="${TEMP}/lams/">
                <include name="wrapper.conf" />
            </fileset>
            <filterset>
                <filter token="JAVA_HOME" value="${JDK_DIR_UNIX_SLASH}" />
            </filterset>
        </copy>
    </target>
    
	<target name="add-autopatch-table" description="Updates wrapper.conf to have the newest configuration">        
		<sql driver="com.mysql.jdbc.Driver" 
			classpath="${INSTDIR}/jboss-4.0.2/server/default/deploy/lams.ear/mysql-connector-java-3.1.12-bin.jar" 
			url="${db.url}" 
			userid="${db.username}" 
			password="${db.password}"
			encoding="utf8"
			onerror="abort">
	            <transaction src="${TEMP}/lams/addAutoPatchTable.sql" />
		</sql>
	</target>
    
</project>