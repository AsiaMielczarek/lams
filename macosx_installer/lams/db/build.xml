<?xml version="1.0"?>

<!-- 
The DOCTYPE declaration declares the location of database-specific parts of the
Ant build file. 
-->
<project name="LAMS" basedir="." default="insert-data">

	<!-- import properties from the specified file -->
	<property file="db.properties"/>
	
	<!-- =================================================================== -->
	<!-- Insert data to mysql                                                -->
	<!-- This tasks creates the database and the LAMS datamodel              -->
	<!-- =================================================================== -->
	<target name="create-db"
		description="Create LAMS db in mysql">
		<sql driver="${db.driver}" url="jdbc:mysql://${db.host}/mysql?characterEncoding=utf8" userid="root"
				password="${db.root.password}"  encoding="${db.encoding}">
			<classpath>
				<pathelement location="${db.driver.jar}"/>
			</classpath>
			<transaction src="create-db.sql"/>
		</sql>
	</target>
	<target name="insert-data"
		description="insert data to mysql" depends="create-db">
		<sql driver="${db.driver}" url="jdbc:mysql://${db.host}/${db.name}?characterEncoding=utf8" userid="${db.username}"
		     password="${db.password}"  encoding="${db.encoding}" keepformat="true" 
		     onerror="abort">
			<classpath>
				<pathelement location="${db.driver.jar}"/>
			</classpath>
			<transaction src="${db.script}"/>
		</sql>
	</target>
</project>

