<?xml version="1.0"?>

<!-- 
  Copyright (C) 2005 LAMS Foundation (http://lamsfoundation.org)

  This program is free software; you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation; either version 2 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU General Public License for more details.

  You should have received a copy of the GNU General Public License
  along with this program; if not, write to the Free Software
  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307
  USA

  http://www.gnu.org/licenses/gpl.txt 
-->

<!-- 
The DOCTYPE declaration declares the location of database-specific parts of the
Ant build file. 
-->
<!DOCTYPE project [
	<!ENTITY properties SYSTEM "file:./properties.xml">
]>

<project name="LAMS" basedir="." default="usage">

	<!-- import properties from the specified file -->
	<property file="build.properties"/>

	<path id="all-libs">
		<fileset dir="${lib}">
			<include name="**/*.jar"/>
		</fileset>
		<fileset dir="${sharedlib}">
			<include name="**/*.jar"/>
		</fileset>
		<fileset dir="${j2eelibs}">
			<include name="**/*.jar"/>
		</fileset>
	</path>

	<path id="project.classpath">
		<path refid="all-libs"/>
		<!-- Java CLASSPATH should be added as the last item -->
		<!-- This property is supposed to be set in eclipse  -->
		<pathelement location="${java.class.path}" />
	</path>

	<target name="usage">
		<echo message=""/>
		<echo message="${project} build file"/>
		<echo message="------------------------------------------------------"/>
		<echo message=""/>
		<echo message="Among the available targets are:"/>
		<echo message=""/>
		<echo message="build-war  --> Make war archive for deployment"/>
		<echo message="clean-build  --> Make war archive for deployment"/>
		<echo message=""/>
	</target>

	<target name="init">
	</target>

	<target name="print-classpath">
		<echo message="java.class.path = ${java.class.path}"/>
	</target>

	<!-- ================================================================ -->
	<!-- Preparations									                  -->
	<!-- ================================================================ -->
	<target name="preparedirs">
		<mkdir dir="${build}"/>
		<mkdir dir="${build.lib}"/>
	</target>


	<target name="clean-build" depends="preparedirs" description="removes all class files">
		<delete dir="${build.lib}"/>
		<mkdir dir="${build.lib}"/>
	</target>


	<!-- = = = = = = = = = = = = = = = = = = = = = = = =  -->
	<!-- Make the war archive  for deployment             -->
	<!-- = = = = = = = = = = = = = = = = = = = = = = = =  -->
	<target name="build-war" depends="clean-build" description="creates war file">
		<delete file="${build.lib}/${product}.war"/>
		<copy overwrite="yes" file="${web}/css/aqua.css" tofile="${web}/css/default.css"/>
		<war warfile="${build.lib}/${product}.war" 
  				webxml="${webinf}/web.xml">
			<webinf dir="${webinf}">
				<include name="*.xml"/>
				<include name="*.properties"/>
				<include name="struts/*"/>
				<include name="jstl/*"/>
				<exclude name="web.xml"/>
			</webinf>
			<fileset dir="${web}">
				<include name="*"/>
				<include name="css/*"/>
				<include name="includes/**"/>
				<include name="images/*"/>
				<include name="admin/*"/>
				<include name="doc/*"/>
				<include name="fckeditor/**/*"/>
			</fileset>
		</war>
	</target>

</project>

