<jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.2">
  <!-- Make sub deployments isolated by default, so they cannot see each others classes without a Class-Path entry -->
  <ear-subdeployments-isolated>true</ear-subdeployments-isolated>
  <deployment>
    <!-- exclude-subsystem prevents a subsystems deployment unit processors running on a deployment -->
    <!-- which gives basically the same effect as removing the subsystem, but it only affects single deployment 
    <exclude-subsystems>
        <subsystem name="resteasy" />
    </exclude-subsystems>
    -->
    
    <!-- Exclusions allow you to prevent the server from automatically adding some dependencies     
    <exclusions>
        <module name="org.javassist" />
    </exclusions>
    -->
    
    <!-- This allows you to define additional dependencies, it is the same as using the Dependencies: manifest attribute -->
    <dependencies>
      <module name="org.apache.poi" />
      <module name="org.apache.aspirin" />
      <module name="com.tacitknowledge.autopatch" />
      <module name="org.apache.axis" /> <!-- depends on: saaj, jaxrpc -->
      <module name="org.apache.batik" />
      <module name="net.sf.cglib" />
      <module name="net.fckeditor" />
      <module name="com.flagstone" />
      <module name="org.apache.commons.beanutils" /> <!-- depends on: commons logging, commons collections -->
      <module name="org.apache.commons.io" />
      <module name="org.apache.commons.lang" />
      <module name="org.apache.commons.codec" />
      <module name="org.apache.commons.pool" />
      <module name="org.apache.commons.fileupload" />
      <module name="org.apache.commons.httpclient" />
      <module name="org.apache.commons.validator" />
      <module name="org.hibernate.cache" />
      <module name="org.jboss.cache" />
      <module name="org.jgroups" />
      <module name="org.jboss.jbossweb" />
      <module name="org.jdom" slot="0.7" />
      <module name="org.verisign.joid" />
      <module name="com.google.gson" />
      <module name="org.apache.lucene" slot="2.4" />
      <module name="org.quartz" />
      <module name="uk.ac.reload" />
      <module name="org.springframework" />
      <module name="org.apache.struts" /> <!-- depends on: antlr, apache oro -->
      <module name="org.apache.strutsel" /> <!-- depends on: struts -->
      <module name="org.tuckey.urlrewrite" />
      <module name="com.allaire.wddx" />
      <module name="org.apache.xmlcommons" />
      <module name="com.thoughtworks.xstream" /> <!-- depends on: xom, xpp, joda -->
      <module name="org.lamsfoundation.lams.session" />
      <module name="org.lamsfoundation.lams.valve" />
      
      <!-- Import META-INF/services for ServiceLoader impls as well
      <module name="myservicemodule" services="import"/>
       -->
    </dependencies>
    
    <!-- These add additional classes to the module. In this case it is the same as including the jar in the EAR's lib directory
    <resources>
      <resource-root path="my-library.jar" />
    </resources>
     -->
  </deployment>
  
  
  <!--
  <sub-deployment name="myapp.war">
    This corresponds to the module for a web deployment 
    it can use all the same tags as the <deployment> entry above 
    <dependencies>
       Adds a dependency on a ejb jar. This could also be done with a Class-Path entry 
      <module name="deployment.myear.ear.myejbjar.jar" />
    </dependencies>
   	Set's local resources to have the lowest priority 
    If the same class is both in the sub deployment and in another sub deployment that 
    is visible to the war, then the Class from the other deployment will be loaded,  
    rather than the class actually packaged in the war.
    This can be used to resolve ClassCastExceptions  if the same class is in multiple sub deployments
    <local-last value="true" />
  </sub-deployment>
  Now we are going to define two additional modules
  This one is a different version of javassist that we have packaged 
  <module name="deployment.myjavassist" >
    <resources>
     <resource-root path="javassist.jar" >
       We want to use the servers version of javassist.util.proxy.* so we filter it out
       <filter>
         <exclude path="javassist/util/proxy" />
       </filter>
     </resource-root>
    </resources>
  </module>
  This is a module that re-exports the containers version of javassist.util.proxy
  This means that there is only one version of the Proxy classes defined          
  <module name="deployment.javassist.proxy" >
    <dependencies>
      <module name="org.javassist" >
        <imports>
          <include path="javassist/util/proxy" />
          <exclude path="/**" />
        </imports>
      </module>
    </dependencies>
  </module>
  -->
</jboss-deployment-structure>