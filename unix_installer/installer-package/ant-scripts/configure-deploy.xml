<?xml version="1.0" encoding="UTF-8"?>

<project name="configure-deploy" basedir="..">
	<property file="lams.properties" />
	
	<target name="configure-wrapper" description="Configuring the JAVA service Wrapper">
		<echo message="Copying the configuration files required for the wrapper"/>
		
		<copy overwrite="true" todir="${JBOSS_DIR}/conf/" failonerror="true">
                        <fileset dir="wrapper">
                                <include name="wrapper.conf" />
                        </fileset>
                	<filterset>
                        	<filter token="JAVA_HOME" value="${JDK_DIR}"/>
               		</filterset>
		</copy>
	
	</target>

	<target name="copy-conf" description="Copying the configuration files required for LAMS">
		<echo message="Copying the configuration files required for LAMS"/>
		<copy overwrite="true" todir="${DEFAULT_DIR}/conf/" failonerror="true">
			<fileset dir="${JBOSS_CONF}/">
				<include name="login-config.xml" />
				<include name="log4j.xml" />
				<include name="jboss-service.xml" />
			</fileset>
		<filterset>
			<filter token="confdir" value="${DEFAULT_DIR}/conf"/>
		</filterset>
		</copy>

		<copy overwrite="true" todir="${DEFAULT_DIR}/conf/" failonerror="true">
			<fileset dir="${AUTH_CONF}/">
				<include name="*.xml" />
				<include name="*.dtd" />
			</fileset>
		<filterset>
			<filter token="confdir" value="${DEFAULT_DIR}/conf" />
		</filterset>
		</copy>

		<copy overwrite="true" todir="${DEPLOY_DIR}" failonerror="true">
			<fileset dir="${JBOSS_CONF}/service">
				<include name="mysql*.xml" />
			</fileset>
			<filterset>
				<filter token="DB_NAME" value="${DB_NAME}" />
				<filter token="DB_USER" value="${DB_USER}" />
				<filter token="DB_PASS" value="${DB_PASS}" />
			</filterset>
		</copy>
		<copy overwrite="true" todir="${DEPLOY_DIR}" failonerror="true">
			<fileset dir="${JBOSS_CONF}/service">
				<include name="local-service.xml" />
			</fileset>
		</copy>

		<copy overwrite="true" todir="${EAR_DIR}/jbossweb-tomcat55.sar/META-INF" failonerror="true">
			<fileset dir="${JBOSS_CONF}/tomcat">
				<include name="jboss-service.xml" />
			</fileset>
		</copy>

		<copy overwrite="true" todir="${DEPLOY_DIR}/jbossweb-tomcat55.sar/" failonerror="true">
			<fileset dir="${JBOSS_CONF}/tomcat">
				<include name="server.xml" />
			</fileset>
			<filterset>
				<filter token="LAMS_PORT" value="${LAMS_PORT}"/>
			</filterset>
		</copy>

		<copy overwrite="true" todir="${DEPLOY_DIR}/jbossweb-tomcat55.sar/" failonerror="true">
			<fileset dir="${JBOSS_CONF}/tomcat">
				<include name="context.xml" />
			</fileset>
		</copy>

		<copy overwrite="true" todir="${EAR_DIR}/jbossweb-tomcat55.sar/conf" failonerror="true">
			 <fileset dir="${JBOSS_CONF}/tomcat">
				 <include name="web.xml" />
			 </fileset>
		</copy>
		
		<copy overwrite="yes" todir="${BINDIR}">
                        <fileset dir="bin">
                                <include name="run-lams.sh" />
                        </fileset>
                        <filterset>
                                <filter token="JAVA_HOME" value="${JDK_DIR}" />
                        </filterset>
                </copy>

	 </target>

</project>


