<?xml version="1.0" encoding="UTF-8"?>
<project name="update-deploy-tools" >
	<!-- begin properties *******************************************************************************************-->
	<!-- import properties from the specified file -->
	
	<property file="../lams.properties"/>
	
	<target name="update-core-database"  description="Runs some update scripts found in lams_common\db\sql\updatscripts">
		<sql driver="com.mysql.jdbc.Driver" 
			classpath="${DEPLOY_DIR}/lams.ear/mysql-connector-java-3.1.12-bin.jar" 
			url="${SQL_URL}" 
			userid="${DB_USER}" 
			password="${DB_PASS}"
			encoding="utf8"
			onerror="abort"
			>
			<transaction src="../sql-scripts/alter_21_branching.sql" />
			<transaction src="../sql-scripts/alter_21_groupings_fckeditor.sql" />
			<transaction src="../sql-scripts/updateLocales.sql" />
		</sql>
		
		<!-- REMOVE BELOW FOR 2.2 -->
		<echo></echo>
		<echo>The below script will fail if the database tables are already INNODB, this will not affect the update.</echo>
		<sql driver="com.mysql.jdbc.Driver" 
			classpath="${DEPLOY_DIR}/lams.ear/mysql-connector-java-3.1.12-bin.jar" 
			url="${SQL_URL}" 
			userid="${DB_USER}" 
			password="${DB_PASS}"
			encoding="utf8"
			onerror="continue"
			>
            <transaction src="../sql-scripts/alter_21_engine.sql" />
        </sql>
	</target>
</project>

