<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

#set( $currentLCID = $session.getCurrentLCID() )
#set( $pt_id = $request.getParameter( $id_param_name ) )
#set( $url = 'ptLaunch.dowebct' )
## check if we're in MyWebCT or a section
#set( $isInstRole = 0 )
#set( $isMyWebCT = 0 )
#if( $currentLCID == $session.getInstitutionID() )
    #set( $isMyWebCT = 1 )
    #set( $id_param_name = 'tid' )

    ## check if it's an Institution role
    #set( $roles = $context.getRoleIDs($session, $currentLCID) )
    #foreach( $role in $roles )
        #set( $isInstRole = 1 )
    #end
#else
    #set( $id_param_name = 'id' )
#end

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>LAMS: Teach</title>

<script language="JavaScript" type="text/javascript">
<!--
	var learnerWin = null;
	var monitorWin = null;
	var liveEditUrl= null;
	var learnerUrl = null;
	var monitorUrl = null;
	
	function openLearner(lsID)
	{
		learnerUrl = '$learnerUrl' + '&lsid=' + lsID; 
		if(learnerWin && learnerWin.open && !learnerWin.closed){
	        try {
	        	learnerWin.focus();
	        }catch(e){
	        	// popups blocked by a 3rd party
	        }
	    }
	    else{
	        try {
	            learnerWin = window.open(learnerUrl,'lWin','width=800,height=600,resizable=1');
	            learnerWin.focus();
	        }catch(e){
	        	// popups blocked by a 3rd party
	        }
	    }
	}
	

	function openMonitor(lsID)
	{
		monitorUrl = '$monitorUrl' + '&lsid=' + lsID; 
    	if(monitorWin && monitorWin.open && !monitorWin.closed){
    	
            try {
            	monitorWin.focus();
            }catch(e){
            	// popups blocked by a 3rd party
            }
        }
        else{
            try {
            	monitorWin = window.open(monitorUrl,'aWin','width=800,height=600,resizable=1');
            	monitorWin.opener = self;
            	monitorWin.focus();
            }catch(e){
            	// popups blocked by a 3rd party
            }
            
        }
	}
	
	function openAuthorForEditOnFly( ldID )
	{				
		liveEditUrl= '$liveEditUrl' + '&layout=editonfly&learningDesignID=' + ldID;
		if(monitorWin && !monitorWin.closed)
		{
			monitorWin.location = liveEditUrl;
		}
		else
		{
			monitorWin = window.open(liveEditUrl,'width=800,height=600,resizable');
			monitorWin.focus();
		}
	}
	
	function setLsId( lsID, form_action)
	{
		document.getElementById("form_action").value=form_action;
		document.getElementById("lsID").value=lsID;
	}
	
	function deleteLesson( lsID, form_action)
	{
		var answer = confirm("Do you really want to delete this lesson? Once deleted you cant get it back.")
		if (answer){
			setLsId( lsID, form_action);
		}
		else{
			return false;
		}
	}

	
//-->

</script>
</head>
<body>
<h3>LAMS Teaching</h3>
<br>
<form enctype="application/x-www-form-urlencoded" name="teach_form" id="teach_form" action="$url" method="post">
	<input type="hidden" name="$id_param_name" value="$pt_id"/>
	<input type="hidden" name="page_id" value="$page_id"/>
	<input type="hidden" name="form_action" id="form_action" value="create_lesson"/>
	<input type="hidden" name="lsID" id="lsID" value="0"/>
	<input type="submit" name="create" value="Create LAMS Lesson"/>
<br>
<b>Lessons Running</b>
<br>
<br>
<table border='0' cellpadding='10'>	
#foreach ($lesson in $lessons)
	<tr>
		<td valign='top'><b>$lesson.getTitle()</b></td>
		<td valign='top'>$lesson.getDescription()</td>
		<td valign='top'>
			<input type="button" name="action" onClick="openLearner($lesson.getLessonId());" value="Open Learner">
		</td>
		<td valign='top'>
			<input type="button" name="action" onClick="openMonitor($lesson.getLessonId());" value="Open Monitor">
		</td>
		<td valign='top'>
			<input type="submit" name="action" onClick="setLsId($lesson.getLessonId(),'modify_lesson');" value="Modify">
		</td>
		<td valign='top'>
			<input type="submit" name="action" onClick="return deleteLesson($lesson.getLessonId(),'delete_lesson');" value="Delete">
		</td>
	</tr>
#end
</table>
</form>




</body>
</html>