<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	
#set( $currentLCID = $session.getCurrentLCID() )
#set( $pt_id = $request.getParameter( $id_param_name ) )
#set( $url = 'ptLaunch.dowebct' )
## check if we're in MyWebCT or a section
#set( $isInstRole = 0 )
#set( $isMyWebCT = 0 )
#if( $currentLCID == $session.getInstitutionID() )
    #set( $isMyWebCT = 1 )
    #set( $id_param_name = 'tid' )

    ## check if it's an Institution role
    #set( $roles = $context.getRoleIDs($session, $currentLCID) )
    #foreach( $role in $roles )
        #set( $isInstRole = 1 )
    #end
#else
    #set( $id_param_name = 'id' )
#end

<head>
<title>LAMS: Teach</title>

<link rel="stylesheet" href="/webct/css/styles.jsp?locale=en_US&Id=9778001&colorSetId=A" type="text/css" />

<script language="JavaScript" type="text/javascript">
<!--
	var learnerWin = null;
	var monitorWin = null;
	var liveEditUrl= null;
	var learnerUrl = null;
	var monitorUrl = null;
	var authorUrl = null;
	var authorWin = null;
	
	function openLearner(lsID)
	{
		learnerUrl = '$learnerUrl' + '&lsid=' + lsID; 
		if(learnerWin && learnerWin.open && !learnerWin.closed){
	        try {
	        	learnerWin.focus();
	        }catch(e){
	        	// popups blocked by a 3rd party
	        }
	    }
	    else{
	        try {
	            learnerWin = window.open(learnerUrl,'lWin','width=800,height=600,resizable=1');
	            learnerWin.focus();
	        }catch(e){
	        	// popups blocked by a 3rd party
	        }
	    }
	}
	

	function openMonitor(lsID)
	{
		monitorUrl = '$monitorUrl' + '&lsid=' + lsID; 
    	if(monitorWin && monitorWin.open && !monitorWin.closed){
    	
            try {
            	monitorWin.focus();
            }catch(e){
            	// popups blocked by a 3rd party
            }
        }
        else{
            try {
            	monitorWin = window.open(monitorUrl,'aWin','width=800,height=600,resizable=1');
            	monitorWin.opener = self;
            	monitorWin.focus();
            }catch(e){
            	// popups blocked by a 3rd party
            }
            
        }
	}
	
	function openAuthorForEditOnFly( ldID )
	{				
		liveEditUrl= '$liveEditUrl' + '&layout=editonfly&learningDesignID=' + ldID;
		if(monitorWin && !monitorWin.closed)
		{
			monitorWin.location = liveEditUrl;
		}
		else
		{
			monitorWin = window.open(liveEditUrl,'width=800,height=600,resizable');
			monitorWin.focus();
		}
	}
	
	function setLsId( lsID, form_action)
	{
		document.getElementById("form_action").value=form_action;
		document.getElementById("lsID").value=lsID;
	}
	
	function modifyLesson( lsID, form_action)
	{
		setLsId( lsID, form_action);
		formSubmit();
	}
	
	function deleteLesson( lsID, form_action)
	{
		var answer = confirm("Do you really want to delete this lesson? Once deleted you cant get it back.")
		if (answer){
			setLsId( lsID, form_action);
			formSubmit();
		}
	}
	
	function formSubmit()
	{
		document.teach_form.submit();
	}
	
	function openAuthor()
    {
    	authorUrl = '${authorUrl}'; 
    	authorUrl += "&notifyCloseURL="
    	if(authorWin && authorWin.open && !authorWin.closed){
    		try {
            	authorWin.focus();
            }catch(e){
		        // popups blocked by a 3rd party
		   	}
        }
        else{
            try {
            	authorWin = window.open(authorUrl,'aWindow','width=800,height=600,resizable');
            	authorWin.focus();
            }catch(e){
		        // popups blocked by a 3rd party
		    }
        }
    }

	
//-->

</script>
</head>
<body class="listingpage">

<h1>LAMS Teaching</h1>
<br>
<form enctype="application/x-www-form-urlencoded" name="teach_form" id="teach_form" action="$url" method="get">
	<input type="hidden" name="$id_param_name" value="$pt_id"/>
	<input type="hidden" name="page_id" value="$page_id"/>
	<input type="hidden" name="form_action" id="form_action" value="create_lesson"/>
	<input type="hidden" name="lsID" id="lsID" value="0"/>
	#if ( $canAuthor )
		<div class="actionbuttondiv">
			<a class="action" tabindex="1" href="javascript:openAuthor()">Open LAMS Author</a>
			<a class="action" tabindex="1" href="javascript:formSubmit()">Create LAMS Lesson</a>
		</div>
	
		<br><br>
		<hr>
		<br>
	#end

		
	
	
#if( $lessons.size() > 0 )	
	<table width='100%' cellpadding='10' style="padding:10px 10px 10px 10px;" class="tablebody">	
	<thead>
	<tr>
		<th>LAMS Lessons Running</th>
		<th></th>
		<th></th>
		<th></th>
	</tr>
	</thead>
	<tbody>
	
	#foreach ($lesson in $lessons)
		<tr>
			<td valign='top'><b>$lesson.getTitle()</b>&nbsp;&nbsp;&nbsp;&nbsp;
			<i>
				
				#set( $startStr = $lesson.getStartStr() )
				#set( $endStr = $lesson.getEndStr() ) 
				
				
				#if( $startStr != '' )
					#if( $endStr != '' )
						Scheduled from: $startStr to $endStr &nbsp;	 
					#else
						Scheduled from: $startStr &nbsp;
					#end
					
					#if( $lesson.getHidden() )
						(Hidden)
					#end
				#elseif( $lesson.getHidden() )
					Hidden
				#else
					Running
				#end

			
			</i>
			
			<p>
			<i>$lesson.getDescription()</i>
			</p>
			
			#set( $start = '' )
			#set( $end = '' )
			#set( $endStr = '' )
			
			
			
			<!--
			<td valign='top'><i>$lesson.getHidden()</i></td>
			<td valign='top'><i>$lesson.getSchedule()</i></td>
			
			#set( $start = '' )
			#set( $end = '' )
			
			#if( $lesson.getSchedule() )		
				#set( $start = $lesson.getStartTimestamp() )
				#set( $end = $lesson.getEndTimestamp() )
				<td valign='top'><i>$start.toString()</i></td>
				<td valign='top'><i>$end.toString()</i></td>
			#else
   				<td valign='top' align='center'></td>
   				<td valign='top' align='center'></td>
			#end
			-->
	
			<p>
				
					#if ( $canMonitor )
						
						<a class="actionlight" href="javascript:openLearner($lesson.getLessonId())">Open Learner</a>&nbsp;
						
						<a class="actionlight" href="javascript:openMonitor($lesson.getLessonId())">Open Monitor</a>&nbsp;
						
					#end
					#if ( $canAuthor )
						
						<a class="actionlight" href="javascript:modifyLesson($lesson.getLessonId(),'modify_lesson')">Modify</a>&nbsp;
						
						<a class="actionlight" href="javascript:deleteLesson($lesson.getLessonId(),'delete_lesson')">Delete</a>&nbsp;
						
					#end
			</p>		
			</td>
	
		</tr>
	#end
	</tbody>
	</table>
#else
    <i>No LAMS lessons running.</i>
#end
</form>




</body>
</html>