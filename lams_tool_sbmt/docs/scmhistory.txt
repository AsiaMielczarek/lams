v1307200501: This version most comes from Manpreet's source code.
